<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fragmentation statistics • Makurhini</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Fragmentation statistics">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Makurhini</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Fragmentation_statistics.html">Fragmentation statistics</a>
    </li>
    <li>
      <a href="../articles/PC_IIC.html">PC and IIC indexes</a>
    </li>
    <li>
      <a href="../articles/ProtConn.html">ProtConn</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/connectscape/Makurhini/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Fragmentation statistics</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/connectscape/Makurhini/blob/HEAD/vignettes/Fragmentation_statistics.Rmd" class="external-link"><code>vignettes/Fragmentation_statistics.Rmd</code></a></small>
      <div class="hidden name"><code>Fragmentation_statistics.Rmd</code></div>

    </div>

    
    
<style type="text/css">
/* CSS to style chunk headers */
.chunk-title {
  background-color: #f0f0f0; /* Background color */
  border: 1px solid #ccc; /* Border */
  padding: 8px 10px; /* Padding */
  margin-top: 20px; /* Top margin */
  margin-bottom: 10px; /* Bottom margin */
  font-weight: bold; /* Font weight */
}
</style>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/connectscape/Makurhini" class="external-link">Makurhini</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>We explored the <strong> MK_Fragmentation() </strong> to estimate
fragmentation statistics at the landscape and patch/node level.</p>
</div>
<div class="section level2">
<h2 id="example-database">Example database<a class="anchor" aria-label="anchor" href="#example-database"></a>
</h2>
<p>In this example, the <code><a href="../reference/MK_Fragmentation.html">MK_Fragmentation()</a></code> function was
applied to estimate the connectivity of 404 remnant habitat
nodes/patches, which were modeled to 40 non-volant mammal species of the
Trans-Mexican Volcanic System (TMVS) by Correa Ayram et al., (2017).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"habitat_nodes"</span>, package <span class="op">=</span> <span class="st">"Makurhini"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">habitat_nodes</span><span class="op">)</span> <span class="co"># Number of nodes</span></span>
<span><span class="co">#&gt; [1] 404</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_geometry</a></span><span class="op">(</span><span class="va">habitat_nodes</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"#00B050"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Fragmentation_statistics_files/figure-html/polygons-1.png" class="r-plt" width="700"></p>
</div>
<div class="section level2">
<h2 id="mk_fragmentation">MK_Fragmentation()<a class="anchor" aria-label="anchor" href="#mk_fragmentation"></a>
</h2>
<p>To define the edge of the nodes we will use a distance of 500 m from
the limit of the nodes (Haddad et al. 2015).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Fragmentation_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/MK_Fragmentation.html">MK_Fragmentation</a></span><span class="op">(</span>nodes <span class="op">=</span> <span class="va">habitat_nodes</span>, edge_distance <span class="op">=</span> <span class="fl">500</span>, plot <span class="op">=</span> <span class="cn">TRUE</span>, min_node_area <span class="op">=</span> <span class="fl">100</span>, landscape_area <span class="op">=</span> <span class="cn">NULL</span>, area_unit <span class="op">=</span> <span class="st">"km2"</span>, perimeter_unit <span class="op">=</span> <span class="st">"km"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Fragmentation_statistics_files/figure-html/unnamed-chunk-3-1.png" class="r-plt" width="700"><img src="Fragmentation_statistics_files/figure-html/unnamed-chunk-3-2.png" class="r-plt" width="700"></p>
<div class="section level3">
<h3 id="exploring-results">Exploring results<a class="anchor" aria-label="anchor" href="#exploring-results"></a>
</h3>
<ul>
<li>The results are presented as a list, the first result is called
<em>“Summary landscape metrics (Viewer Panel)”</em> and it has
fragmentation statistics at landscape level.</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">Fragmentation_test</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Summary landscape metrics (Viewer Panel)"</span></span>
<span><span class="co">#&gt; [2] "Patch statistics shapefile"</span></span>
<span><span class="va">Fragmentation_test</span><span class="op">$</span><span class="va">`Summary landscape metrics (Viewer Panel)`</span></span></code></pre></div>
<table class="table table table-condensed">
<thead><tr>
<th style="text-align:left;">
Metric
</th>
<th style="text-align:center;">
Value
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Patch area (km2)
</td>
<td style="text-align:center;">
12735.7391
</td>
</tr>
<tr>
<td style="text-align:left;">
Number of patches
</td>
<td style="text-align:center;">
404.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
Size (mean)
</td>
<td style="text-align:center;">
31.5241
</td>
</tr>
<tr>
<td style="text-align:left;">
Patches &lt; minimum patch area
</td>
<td style="text-align:center;">
383.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
Patches &lt; minimum patch area (%)
</td>
<td style="text-align:center;">
28.8879
</td>
</tr>
<tr>
<td style="text-align:left;">
Total edge
</td>
<td style="text-align:center;">
17920.4740
</td>
</tr>
<tr>
<td style="text-align:left;">
Edge density
</td>
<td style="text-align:center;">
1.4071
</td>
</tr>
<tr>
<td style="text-align:left;">
Patch density
</td>
<td style="text-align:center;">
3.1722
</td>
</tr>
<tr>
<td style="text-align:left;">
Total Core Area (km2)
</td>
<td style="text-align:center;">
6315.9513
</td>
</tr>
<tr>
<td style="text-align:left;">
Cority
</td>
<td style="text-align:center;">
0.6040
</td>
</tr>
<tr>
<td style="text-align:left;">
Shape Index (mean)
</td>
<td style="text-align:center;">
2.2073
</td>
</tr>
<tr>
<td style="text-align:left;">
FRAC (mean)
</td>
<td style="text-align:center;">
8.4400
</td>
</tr>
<tr>
<td style="text-align:left;">
MESH (km2)
</td>
<td style="text-align:center;">
1443.4320
</td>
</tr>
</tbody>
</table>
<ul>
<li>The second output <em>“Patch statistics shapefile”</em> is a
shapefile with patch level fragmentation statistics that can be saved
using write_sf() from <em>‘sf’</em> package (<a href="https://cran.r-project.org/web/packages/sf/index.html" class="external-link uri">https://cran.r-project.org/web/packages/sf/index.html</a>).</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">Fragmentation_test</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; Simple feature collection with 6 features and 9 fields</span></span>
<span><span class="co">#&gt; Geometry type: POLYGON</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 40856.86 ymin: 2025032 xmax: 80825.67 ymax: 2066668</span></span>
<span><span class="co">#&gt; Projected CRS: NAD_1927_Albers</span></span>
<span><span class="co">#&gt;   Id     Area     CA CAPercent Perimeter EdgePercent   PARA ShapeIndex     FRAC</span></span>
<span><span class="co">#&gt; 1  1   0.8584  0.000    0.0000     5.989    100.0000 0.1433     1.8235 -23.4460</span></span>
<span><span class="co">#&gt; 2  2   2.2022  0.000    0.0000    11.346    100.0000 0.1941     2.1568   6.1533</span></span>
<span><span class="co">#&gt; 3  3 110.1997 53.378   48.4375   184.969     51.5625 0.5958     4.9705   2.2203</span></span>
<span><span class="co">#&gt; 4  4   1.2100  0.000    0.0000     6.974    100.0000 0.1735     1.7885  20.3776</span></span>
<span><span class="co">#&gt; 5  5   1.8472  0.000    0.0000    14.452    100.0000 0.1278     2.9996   8.7044</span></span>
<span><span class="co">#&gt; 6  6   0.2631  0.000    0.0000     4.685    100.0000 0.0562     2.5766  -2.3133</span></span>
<span><span class="co">#&gt;                         geometry</span></span>
<span><span class="co">#&gt; 1 POLYGON ((54911.05 2035815,...</span></span>
<span><span class="co">#&gt; 2 POLYGON ((44591.28 2042209,...</span></span>
<span><span class="co">#&gt; 3 POLYGON ((46491.11 2042467,...</span></span>
<span><span class="co">#&gt; 4 POLYGON ((54944.49 2048163,...</span></span>
<span><span class="co">#&gt; 5 POLYGON ((80094.28 2064140,...</span></span>
<span><span class="co">#&gt; 6 POLYGON ((69205.24 2066394,...</span></span></code></pre></div>
<ul>
<li>To save the shapefile you can use the ‘write_sf()’ function from
‘sf’ package: write_sf(Fragmentacion_test[[2]],
“…/folder/fragmentacion.shp”)</li>
</ul>
</div>
<div class="section level3">
<h3 id="viewing-the-results">Viewing the results<a class="anchor" aria-label="anchor" href="#viewing-the-results"></a>
</h3>
<p>We can visualize the static at the patch level using the default
<em>plot()</em> function or other spatial information display packages
like the <em>‘tmap’</em> package, for example:</p>
<ul>
<li>Core area (%):</li>
</ul>
<p><img src="Fragmentation_statistics_files/figure-html/unnamed-chunk-6-1.png" class="r-plt" width="700"></p>
<ul>
<li>Edge (%)</li>
</ul>
<p><img src="Fragmentation_statistics_files/figure-html/unnamed-chunk-7-1.png" class="r-plt" width="700"></p>
<ul>
<li>Perimeter-area ratio (PARA)</li>
</ul>
<p><img src="Fragmentation_statistics_files/figure-html/unnamed-chunk-8-1.png" class="r-plt" width="700"></p>
<ul>
<li>Shape Index</li>
</ul>
<p><img src="Fragmentation_statistics_files/figure-html/unnamed-chunk-9-1.png" class="r-plt" width="700"></p>
<ul>
<li>Fractal Dimension Index</li>
</ul>
<p><img src="Fragmentation_statistics_files/figure-html/unnamed-chunk-10-1.png" class="r-plt" width="700"></p>
</div>
<div class="section level3">
<h3 id="exploring-other-edge-depths">Exploring other edge depths<a class="anchor" aria-label="anchor" href="#exploring-other-edge-depths"></a>
</h3>
<p>We can make a loop where we explore different edge depths. In the
following example, We will explore 10 edge depths (<em>edge_distance
argument</em>): 100, 200, 300, 400, 500, 600, 700, 800, 900 and 1000
meters. We will apply the <em>‘MK_Fragmentation’</em> function using the
previous distances and then, we will extract the core area percentage
and edge percentage statistics. Finally, we will plot the average of the
patch core area percentage and edge percentage (% core area + % edge =
100%).</p>
<pre><code><span><span class="co">#&gt;   Edge.distance      Type Percentage</span></span>
<span><span class="co">#&gt; 1           100 Core Area   65.76120</span></span>
<span><span class="co">#&gt; 2           100      Edge   34.23880</span></span>
<span><span class="co">#&gt; 3           200 Core Area   41.98064</span></span>
<span><span class="co">#&gt; 4           200      Edge   58.01936</span></span>
<span><span class="co">#&gt; 5           300 Core Area   26.85321</span></span>
<span><span class="co">#&gt; 6           300      Edge   73.14679</span></span></code></pre>
<p><img src="Fragmentation_statistics_files/figure-html/unnamed-chunk-12-1.png" class="r-plt" width="700"></p>
<p>The average core area percentage (average patch area that has the
least possible edge effect) for all nodes decreases by more than 70%
when considering an edge effect with an edge depth distance of 1 km.</p>
<table class="table">
<thead><tr class="header">
<th>Edge depth distance (m)</th>
<th align="center">CoreArea (%)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>100</td>
<td align="center">83.5%</td>
</tr>
<tr class="even">
<td>500</td>
<td align="center">34.14%</td>
</tr>
<tr class="odd">
<td>1000</td>
<td align="center">9.78%</td>
</tr>
</tbody>
</table>
<p><strong>Reference</strong>:</p>
<ul>
<li><p>INEGI. (2013). Conjunto de datos vectoriales de uso del suelo y
vegetación, serie V (capa unión), escala 1:250,000. Instituto Nacional
de Estadística y Geografía, Aguascalientes.</p></li>
<li><p>McGarigal, K., S. A. Cushman, M. C. Neel, and E. Ene. 2002.
FRAGSTATS: Spatial Pattern Analysis Program for Categorical Maps.
Computer software program produced by the authors at the University of
Massachusetts, Amherst. Available at the following web site:
www.umass.edu/landeco/research/fragstats/fragstats.html.</p></li>
<li><p>Haddad et al. (2015). Science Advances 1(2):e1500052. DOI:
10.1126/sciadv.1500052.</p></li>
</ul>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Oscar Godínez-Gómez, Camilo A. Correa Ayram.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
